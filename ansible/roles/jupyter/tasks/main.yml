- name: Ensure python3-pip
  ansible.builtin.apt:
    name: python3-pip
    state: present
    update_cache: true

- name: Install JupyterLab
  ansible.builtin.pip:
    name: jupyterlab

- name: Create systemd service for JupyterLab
  ansible.builtin.copy:
    dest: /etc/systemd/system/jupyterlab.service
    mode: '0644'
    content: |
      [Unit]
      Description=JupyterLab
      After=network.target

      [Service]
      Type=simple
      User={{ admin_user }}
      ExecStart=/usr/bin/jupyter lab --ip=0.0.0.0 --no-browser
      Restart=always

      [Install]
      WantedBy=multi-user.target
  notify: Restart jupyter
